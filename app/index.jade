html(lang='en')
  head
    link(href="./bower_components/foundation-5/css/normalize.css", rel="stylesheet")
    link(href="./bower_components/foundation-5/css/foundation.css", rel="stylesheet")
    link(href="./bower_components/pixeden-stroke-7-icon/pe-icon-7-stroke/css/helper.css", rel="stylesheet")
    link(href="./bower_components/pixeden-stroke-7-icon/pe-icon-7-stroke/css/pe-icon-7-stroke.css", rel="stylesheet")
    //- link(href="./bower_components/pixeden-stroke-7-icon/pe-icon-7-stroke/css/pe-icon-7-filled.css", rel="stylesheet")
    link(href="./assets/css/app.css", rel="stylesheet")
    script(src="./bower_components/angular/angular.js")
    script(src="./bower_components/jquery/dist/jquery.js")
    script(src="./bower_components/angular-animate/angular-animate.js")
    script(src="./bower_components/angular-foundation/mm-foundation-tpls.js")
    script(src="./bower_components/angular-foundation/mm-foundation.js")
    script(src="./bower_components/store.js-master/store.min.js")
    script(src="./node_modules/underscore/underscore-min.js")
    //- script(src="./assets/js/blur.js")
    script(src="./assets/js/resizer.js")
    script(src="./assets/js/database.js")
    script(src="./assets/js/app.js")
    script.
      win.on('close', function() {
        this.hide(); // Pretend to be closed already
        console.log("We're closing...");
        this.close(true);
      });


  body(ng-app="apollo")
    .top(ng-controller="menuCtrl")
      .topbar  
        .small-4.large-4.columns
          span.left.frame
            a(href="javascript:void(0)" onclick="win.close();")
              i.pe-7s-close.pe-3x
          span.left.frame
            a(href="javascript:void(0)" onclick="win.minimize();")
              i.pe-7s-close.pe-3x
          span.left.frame
            a(href="javascript:void(0)" onclick="win.maximize();")
              i.pe-7s-close.pe-3x
          //- .switch(ng-class="{hidden: settings}")
          //-   input#exampleCheckboxSwitch(type="checkbox" ng-click="sideBar = !sideBar")
          //-   label(for="exampleCheckboxSwitch")
          
        .small-4.large-4.columns.center 
          h5 APOLLO
        .small-4.large-4.columns.right 
          a(href="javascript:void(0)" ng-click="menu = !menu" ng-hide="settings")
            i.pe-7s-menu.pe-2x          
          a(href="javascript:void(0)" ng-click="settings = !settings" ng-show="settings")
            i.pe-7s-close.pe-3x.closeRight
      .content
        .menu(ng-show="menu").fadeDown
          .row.center
            .columns.large-4.small-4.inputCtrl
              .inputWrapper.center
                i.pe-7s-plus.pe-2x
                  input.fileInput(type="file" accept=".xml" onchange="angular.element(this).scope().importItunes(this);")
            .columns.large-4.small-4
              .menuIcon
                a(href="javascript:void(0)" ng-click="findLibrary()")
                  i.pe-7s-loop.pe-2x

            .columns.large-4.small-4
              .menuIcon.center(href="javascript:void(0)" ng-click="settings = !settings")
                a
                  i.pe-7s-config.pe-2x
        .music
          table(ng-class="{blurOut: focus}")
            thead
              tr
                th Title
                th Artist
                th Album
                th Year              
                th Genre              
                th Play Count
            tbody(ng-if="populated")
              tr(ng-repeat="song in library" ng-click="getSong(song)")
                td {{song.Name}}
                td {{song.Artist}}              
                td {{song.Album}}
                td {{song.Year}}
                td {{song.Genre}}
                td {{song["Play Count"]}}
        

        .settings(ng-show="settings").fadeIn
        .waiting(ng-show="waiting").fadeIn.center
          #loading
            -for(n=0; n<3; n++)
              span
        .focusBlur(ng-show="focus" ng-click="unBlur()").fadeIn
        .focus(ng-show="focus" ng-click="addSong = ''").fadeIn
          a.close(href="javascript:void(0)" ng-click="focus = !focus")
            i.pe-7s-close.pe-3x
          .info
            p {{selectedSong.Name}}
            p {{selectedSong.Artist}}  
            p {{selectedSong.Album}}
            p(ng-repeat="child in selectedSongChildren") {{child.Name}}

            //- refactor to directive
            input(type="text" ng-model="addSong")
            br
            br
            .bubble(ng-if="addSong")
              p.seeMore(ng-if="addSong && (library | filter:addSong).length > 6") 
                | See {{ (library | filter:addSong).length - 6}} More Results.
    
              .container(ng-repeat="song in dogs = (library | filter:addSong | limitTo:6)" ) 
                p(ng-click="addLink(song);")  {{song.Name}} - {{song.Artist}}
              p.indent(ng-if="addSong && (library | filter:addSong).length > 6") ...
              p.indent(ng-if="addSong && (library | filter:addSong).length == 0") No Results
          .links
            p(ng-repeat="song in selectedSong.Children") {{song._id}}
          .bottomBar

        .load(ng-show="load").fadeIn.center
          h1 APOLLO
          //- a(href="javascript:void(0)" ng-click="load = !load")
          //-   i.pe-7s-close.pe-3x.closeRight
          #loading
            -for(n=0; n<3; n++)
              span

    
    script.
      var gui = require('nw.gui');
      var mb = new gui.Menu({type:"menubar"});
      mb.createMacBuiltin("your-app-name");
      gui.Window.get().menu = mb;